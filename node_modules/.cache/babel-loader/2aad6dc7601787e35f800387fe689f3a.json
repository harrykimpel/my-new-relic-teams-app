{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _includes from \"lodash/includes\";\nimport _isArray from \"lodash/isArray\";\nimport _some from \"lodash/some\";\nimport _invoke from \"lodash/invoke\";\nimport { popupBehavior } from '@fluentui/accessibility';\nimport { useAccessibility, useAutoControlled, useTelemetry } from '@fluentui/react-bindings';\nimport { EventListener } from '@fluentui/react-component-event-listener';\nimport { Unstable_NestingAuto } from '@fluentui/react-component-nesting-registry';\nimport { handleRef, Ref } from '@fluentui/react-component-ref';\nimport * as customPropTypes from '@fluentui/react-proptypes';\nimport * as keyboardKey from 'keyboard-key';\nimport * as PropTypes from 'prop-types';\nimport * as React from 'react'; // @ts-ignore\n\nimport { ThemeContext } from 'react-fela';\nimport { childrenExist, commonPropTypes, isFromKeyboard, doesNodeContainClick, setWhatInputSource } from '../../utils';\nimport { ALIGNMENTS, POSITIONS, Popper } from '../../utils/positioner';\nimport PopupContent from './PopupContent';\nimport { createShorthandFactory } from '../../utils/factories';\nimport createReferenceFromContextClick from './createReferenceFromContextClick';\nimport isRightClick from '../../utils/isRightClick';\nimport PortalInner from '../Portal/PortalInner';\nexport var popupClassName = 'ui-popup';\n/**\n * A Popup displays a non-modal, often rich content, on top of its target element.\n */\n\nvar Popup = function Popup(props) {\n  var context = React.useContext(ThemeContext);\n\n  var _useTelemetry = useTelemetry(Popup.displayName, context.telemetry),\n      setStart = _useTelemetry.setStart,\n      setEnd = _useTelemetry.setEnd;\n\n  setStart();\n  var accessibility = props.accessibility,\n      align = props.align,\n      autoFocus = props.autoFocus,\n      inline = props.inline,\n      children = props.children,\n      contentRef = props.contentRef,\n      flipBoundary = props.flipBoundary,\n      on = props.on,\n      mountNode = props.mountNode,\n      mouseLeaveDelay = props.mouseLeaveDelay,\n      offset = props.offset,\n      overflowBoundary = props.overflowBoundary,\n      pointing = props.pointing,\n      position = props.position,\n      positionFixed = props.positionFixed,\n      renderContent = props.renderContent,\n      tabbableTrigger = props.tabbableTrigger,\n      target = props.target,\n      trapFocus = props.trapFocus,\n      trigger = props.trigger,\n      unstable_pinned = props.unstable_pinned;\n\n  var _useAutoControlled = useAutoControlled({\n    initialValue: false,\n    defaultValue: props.defaultOpen,\n    value: props.open\n  }),\n      _useAutoControlled2 = _slicedToArray(_useAutoControlled, 2),\n      open = _useAutoControlled2[0],\n      setOpen = _useAutoControlled2[1];\n\n  var _React$useState = React.useState(false),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      isOpenedByRightClick = _React$useState2[0],\n      setIsOpenedByRightClick = _React$useState2[1];\n\n  var closeTimeoutId = React.useRef();\n  var popupContentRef = React.useRef();\n  var pointerTargetRef = React.useRef();\n  var triggerRef = React.useRef(); // focusable element which has triggered Popup, can be either triggerDomElement or the element inside it\n\n  var triggerFocusableRef = React.useRef();\n  var rightClickReferenceObject = React.useRef();\n  var getA11yProps = useAccessibility(accessibility, {\n    debugName: Popup.displayName,\n    actionHandlers: {\n      closeAndFocusTrigger: function closeAndFocusTrigger(e) {\n        e.preventDefault();\n\n        _close(e, function () {\n          return _invoke(triggerFocusableRef.current, 'focus');\n        });\n      },\n      close: function close(e) {\n        _close(e);\n      },\n      toggle: function toggle(e) {\n        e.preventDefault();\n        trySetOpen(!open, e);\n      },\n      open: function open(e) {\n        e.preventDefault();\n        setPopupOpen(true, e);\n      },\n      preventScroll: function preventScroll(e) {\n        e.preventDefault();\n      }\n    },\n    mapPropsToBehavior: function mapPropsToBehavior() {\n      return {\n        disabled: false,\n        // definition has this prop, but `Popup` doesn't support it\n        isOpenedByRightClick: isOpenedByRightClick,\n        on: on,\n        trapFocus: trapFocus,\n        tabbableTrigger: tabbableTrigger,\n        trigger: trigger\n      };\n    },\n    rtl: context.rtl\n  });\n\n  var handleDocumentClick = function handleDocumentClick(getRefs) {\n    return function (e) {\n      if (isOpenedByRightClick && isOutsidePopupElement(getRefs(), e)) {\n        trySetOpen(false, e);\n        return;\n      }\n\n      if (isOutsidePopupElementAndOutsideTriggerElement(getRefs(), e)) {\n        trySetOpen(false, e);\n      }\n    };\n  };\n\n  var handleDocumentKeyDown = function handleDocumentKeyDown(getRefs) {\n    return function (e) {\n      var keyCode = keyboardKey.getCode(e);\n      var isMatchingKey = keyCode === keyboardKey.Enter || keyCode === keyboardKey.Spacebar;\n\n      if (isMatchingKey && isOutsidePopupElementAndOutsideTriggerElement(getRefs(), e)) {\n        trySetOpen(false, e);\n      } // if focus was lost from Popup and moved to body, for e.g. when click on popup content\n      // and ESC is pressed, the last opened Popup should get closed and the trigger should get focus\n\n\n      var lastContentRef = getRefs().pop();\n      var isLastOpenedPopup = lastContentRef && lastContentRef.current === popupContentRef.current;\n      var activeDocument = context.target;\n      var bodyHasFocus = activeDocument.activeElement === activeDocument.body;\n\n      if (keyCode === keyboardKey.Escape && bodyHasFocus && isLastOpenedPopup) {\n        _close(e, function () {\n          return _invoke(triggerFocusableRef.current, 'focus');\n        });\n      }\n    };\n  };\n\n  var isOutsidePopupElementAndOutsideTriggerElement = function isOutsidePopupElementAndOutsideTriggerElement(refs, e) {\n    var isOutsidePopup = isOutsidePopupElement(refs, e);\n    var isInsideTrigger = triggerRef.current && doesNodeContainClick(triggerRef.current, e, context.target);\n    return isOutsidePopup && !isInsideTrigger;\n  };\n\n  var isOutsidePopupElement = function isOutsidePopupElement(refs, e) {\n    var isInsideNested = _some(refs, function (childRef) {\n      return doesNodeContainClick(childRef.current, e, context.target);\n    });\n\n    var isOutsidePopup = popupContentRef.current && !isInsideNested;\n    return isOutsidePopup;\n  };\n\n  var getTriggerProps = function getTriggerProps(triggerElement) {\n    var triggerProps = {};\n    var normalizedOn = _isArray(on) ? on : [on];\n    /**\n     * The focus is adding the focus, blur and click event (always opening on click)\n     * If focus and context are provided, there is no need to add onClick\n     */\n\n    if (_includes(normalizedOn, 'focus')) {\n      triggerProps.onFocus = function (e) {\n        if (isFromKeyboard()) {\n          trySetOpen(true, e);\n        }\n\n        for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          args[_key - 1] = arguments[_key];\n        }\n\n        _invoke.apply(void 0, [triggerElement, 'props.onFocus', e].concat(args));\n      };\n\n      triggerProps.onBlur = function (e) {\n        if (shouldBlurClose(e)) {\n          trySetOpen(false, e);\n        }\n\n        for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n          args[_key2 - 1] = arguments[_key2];\n        }\n\n        _invoke.apply(void 0, [triggerElement, 'props.onBlur', e].concat(args));\n      };\n\n      if (!_includes(normalizedOn, 'context')) {\n        triggerProps.onClick = function (e) {\n          setPopupOpen(true, e);\n\n          for (var _len3 = arguments.length, args = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n            args[_key3 - 1] = arguments[_key3];\n          }\n\n          _invoke.apply(void 0, [triggerElement, 'props.onClick', e].concat(args));\n        };\n      }\n    }\n    /**\n     * The click is toggling the open state of the popup\n     */\n\n\n    if (_includes(normalizedOn, 'click')) {\n      triggerProps.onClick = function (e) {\n        trySetOpen(!open, e);\n\n        for (var _len4 = arguments.length, args = new Array(_len4 > 1 ? _len4 - 1 : 0), _key4 = 1; _key4 < _len4; _key4++) {\n          args[_key4 - 1] = arguments[_key4];\n        }\n\n        _invoke.apply(void 0, [triggerElement, 'props.onClick', e].concat(args));\n      };\n    }\n    /**\n     * The context is opening the popup\n     */\n\n\n    if (_includes(normalizedOn, 'context')) {\n      triggerProps.onContextMenu = function (e) {\n        setPopupOpen(!open, e);\n\n        for (var _len5 = arguments.length, args = new Array(_len5 > 1 ? _len5 - 1 : 0), _key5 = 1; _key5 < _len5; _key5++) {\n          args[_key5 - 1] = arguments[_key5];\n        }\n\n        _invoke.apply(void 0, [triggerElement, 'props.onContextMenu', e].concat(args));\n\n        e.preventDefault();\n      };\n    }\n    /**\n     * The hover is adding the mouseEnter, mouseLeave, blur and click event (always opening on click)\n     * If hover and context are provided, there is no need to add onClick\n     */\n\n\n    if (_includes(normalizedOn, 'hover')) {\n      triggerProps.onMouseEnter = function (e) {\n        setPopupOpen(true, e);\n        setWhatInputSource(context.target, 'mouse');\n\n        for (var _len6 = arguments.length, args = new Array(_len6 > 1 ? _len6 - 1 : 0), _key6 = 1; _key6 < _len6; _key6++) {\n          args[_key6 - 1] = arguments[_key6];\n        }\n\n        _invoke.apply(void 0, [triggerElement, 'props.onMouseEnter', e].concat(args));\n      };\n\n      triggerProps.onMouseLeave = function (e) {\n        setPopupOpen(false, e);\n\n        for (var _len7 = arguments.length, args = new Array(_len7 > 1 ? _len7 - 1 : 0), _key7 = 1; _key7 < _len7; _key7++) {\n          args[_key7 - 1] = arguments[_key7];\n        }\n\n        _invoke.apply(void 0, [triggerElement, 'props.onMouseLeave', e].concat(args));\n      };\n\n      if (!_includes(normalizedOn, 'context')) {\n        triggerProps.onClick = function (e) {\n          setPopupOpen(true, e);\n\n          for (var _len8 = arguments.length, args = new Array(_len8 > 1 ? _len8 - 1 : 0), _key8 = 1; _key8 < _len8; _key8++) {\n            args[_key8 - 1] = arguments[_key8];\n          }\n\n          _invoke.apply(void 0, [triggerElement, 'props.onClick', e].concat(args));\n        };\n      }\n\n      triggerProps.onBlur = function (e) {\n        if (shouldBlurClose(e)) {\n          trySetOpen(false, e);\n        }\n\n        for (var _len9 = arguments.length, args = new Array(_len9 > 1 ? _len9 - 1 : 0), _key9 = 1; _key9 < _len9; _key9++) {\n          args[_key9 - 1] = arguments[_key9];\n        }\n\n        _invoke.apply(void 0, [triggerElement, 'props.onBlur', e].concat(args));\n      };\n    }\n\n    return triggerProps;\n  };\n\n  var getContentProps = function getContentProps(predefinedProps) {\n    var contentHandlerProps = {};\n    var normalizedOn = _isArray(on) ? on : [on];\n    /**\n     * The focus is adding the focus and blur events on the content\n     */\n\n    if (_includes(normalizedOn, 'focus')) {\n      contentHandlerProps.onFocus = function (e, contentProps) {\n        trySetOpen(true, e);\n        predefinedProps && _invoke(predefinedProps, 'onFocus', e, contentProps);\n      };\n\n      contentHandlerProps.onBlur = function (e, contentProps) {\n        if (shouldBlurClose(e)) {\n          trySetOpen(false, e);\n        }\n\n        predefinedProps && _invoke(predefinedProps, 'onBlur', e, contentProps);\n      };\n    }\n    /**\n     * The hover is adding the mouseEnter, mouseLeave and click event (always opening on click)\n     */\n\n\n    if (_includes(normalizedOn, 'hover')) {\n      contentHandlerProps.onMouseEnter = function (e, contentProps) {\n        setPopupOpen(true, e);\n        predefinedProps && _invoke(predefinedProps, 'onMouseEnter', e, contentProps);\n      };\n\n      contentHandlerProps.onMouseLeave = function (e, contentProps) {\n        setPopupOpen(false, e);\n        predefinedProps && _invoke(predefinedProps, 'onMouseLeave', e, contentProps);\n      };\n\n      contentHandlerProps.onClick = function (e, contentProps) {\n        setPopupOpen(true, e);\n        predefinedProps && _invoke(predefinedProps, 'onClick', e, contentProps);\n      };\n    }\n\n    return contentHandlerProps;\n  };\n\n  var shouldBlurClose = function shouldBlurClose(e) {\n    return !e.currentTarget || !popupContentRef.current || !e.currentTarget.contains(e.relatedTarget) && !popupContentRef.current.contains(e.relatedTarget);\n  };\n\n  var renderPopperChildren = function renderPopperChildren(_ref) {\n    var placement = _ref.placement,\n        scheduleUpdate = _ref.scheduleUpdate;\n    var content = renderContent ? renderContent(scheduleUpdate) : props.content;\n    var popupContent = Popup.Content.create(content || {}, {\n      defaultProps: function defaultProps() {\n        return getA11yProps('popup', Object.assign({}, getContentProps(), {\n          placement: placement,\n          pointing: pointing,\n          pointerRef: pointerTargetRef,\n          trapFocus: trapFocus,\n          autoFocus: autoFocus\n        }));\n      },\n      overrideProps: getContentProps\n    });\n    return React.createElement(Unstable_NestingAuto, null, function (getRefs, nestingRef) {\n      return React.createElement(React.Fragment, null, React.createElement(Ref, {\n        innerRef: function innerRef(domElement) {\n          popupContentRef.current = domElement;\n          handleRef(contentRef, domElement);\n          nestingRef.current = domElement;\n        }\n      }, popupContent), React.createElement(EventListener, {\n        listener: handleDocumentClick(getRefs),\n        target: context.target,\n        type: \"click\",\n        capture: true\n      }), React.createElement(EventListener, {\n        listener: handleDocumentClick(getRefs),\n        target: context.target,\n        type: \"contextmenu\",\n        capture: true\n      }), React.createElement(EventListener, {\n        listener: handleDocumentKeyDown(getRefs),\n        target: context.target,\n        type: \"keydown\",\n        capture: true\n      }), isOpenedByRightClick && React.createElement(React.Fragment, null, React.createElement(EventListener, {\n        listener: dismissOnScroll,\n        target: context.target,\n        type: \"wheel\",\n        capture: true\n      }), React.createElement(EventListener, {\n        listener: dismissOnScroll,\n        target: context.target,\n        type: \"touchmove\",\n        capture: true\n      })));\n    });\n  };\n\n  var dismissOnScroll = function dismissOnScroll(e) {\n    trySetOpen(false, e);\n  };\n\n  var trySetOpen = function trySetOpen(newValue, event) {\n    var isOpenedByRightClick = newValue && isRightClick(event); // when new state 'open' === 'true', save the last focused element\n\n    if (newValue) {\n      updateTriggerFocusableRef();\n      updateContextPosition(isOpenedByRightClick && event.nativeEvent);\n    }\n\n    setOpen(newValue);\n    setIsOpenedByRightClick(isOpenedByRightClick);\n\n    _invoke(props, 'onOpenChange', event, Object.assign({}, props, {}, {\n      open: newValue\n    }));\n  };\n\n  var setPopupOpen = function setPopupOpen(newOpen, e) {\n    clearTimeout(closeTimeoutId.current);\n    newOpen ? trySetOpen(true, e) : schedulePopupClose(e);\n  };\n\n  var schedulePopupClose = function schedulePopupClose(e) {\n    closeTimeoutId.current = setTimeout(function () {\n      trySetOpen(false, e);\n    }, mouseLeaveDelay);\n  };\n\n  var _close = function _close(e, onClose) {\n    if (open) {\n      trySetOpen(false, e);\n      onClose && onClose();\n      e.stopPropagation();\n    }\n  };\n  /**\n   * Save DOM element which had focus before Popup opens.\n   * Can be either trigger DOM element itself or the element inside it.\n   */\n\n\n  var updateTriggerFocusableRef = function updateTriggerFocusableRef() {\n    var activeDocument = context.target;\n    var activeElement = activeDocument.activeElement;\n    triggerFocusableRef.current = triggerRef.current && triggerRef.current.contains(activeElement) ? activeElement : triggerRef.current;\n  };\n\n  var updateContextPosition = function updateContextPosition(nativeEvent) {\n    rightClickReferenceObject.current = nativeEvent ? createReferenceFromContextClick(nativeEvent) : null;\n  };\n\n  if (process.env.NODE_ENV !== 'production') {\n    React.useEffect(function () {\n      if (inline && trapFocus) {\n        // eslint-disable-next-line no-console\n        console.warn('Using \"trapFocus\" in inline popup leads to broken behavior for screen reader users.');\n      }\n\n      if (!inline && autoFocus) {\n        // eslint-disable-next-line no-console\n        console.warn('Beware, \"autoFocus\" prop will just grab focus at the moment of mount and will not trap it. As user is able to TAB out from popup, better use \"inline\" prop to keep correct tab order.');\n      }\n    }, [autoFocus, inline, trapFocus]);\n  }\n\n  React.useEffect(function () {\n    if (open) {\n      // when new state 'open' === 'true', save the last focused element\n      updateTriggerFocusableRef();\n    }\n  });\n  var triggerNode = childrenExist(children) ? children : trigger;\n  var triggerProps = getTriggerProps(triggerNode);\n  var contentElement = open && React.createElement(Popper, {\n    pointerTargetRef: pointerTargetRef,\n    align: align,\n    flipBoundary: flipBoundary,\n    position: position,\n    positionFixed: positionFixed,\n    offset: offset,\n    overflowBoundary: overflowBoundary,\n    rtl: context.rtl,\n    unstable_pinned: unstable_pinned,\n    targetRef: rightClickReferenceObject.current || target || triggerRef,\n    children: renderPopperChildren\n  });\n  var triggerElement = triggerNode && React.createElement(Ref, {\n    innerRef: triggerRef\n  }, React.cloneElement(triggerNode, getA11yProps('trigger', triggerProps)));\n  var element = React.createElement(React.Fragment, null, triggerElement, open && (inline ? contentElement : React.createElement(PortalInner, {\n    mountNode: mountNode\n  }, contentElement)));\n  setEnd();\n  return element;\n};\n\nPopup.displayName = 'Popup';\nPopup.propTypes = Object.assign({}, commonPropTypes.createCommon({\n  as: false,\n  content: false\n}), {\n  align: PropTypes.oneOf(ALIGNMENTS),\n  defaultOpen: PropTypes.bool,\n  inline: PropTypes.bool,\n  mountNode: customPropTypes.domNode,\n  mouseLeaveDelay: PropTypes.number,\n  offset: PropTypes.oneOfType([PropTypes.func, PropTypes.arrayOf(PropTypes.number)]),\n  flipBoundary: PropTypes.oneOfType([PropTypes.object, PropTypes.arrayOf(PropTypes.object), PropTypes.oneOf(['clippingParents', 'window', 'scrollParent'])]),\n  overflowBoundary: PropTypes.oneOfType([PropTypes.object, PropTypes.arrayOf(PropTypes.object), PropTypes.oneOf(['clippingParents', 'window', 'scrollParent'])]),\n  on: PropTypes.oneOfType([PropTypes.oneOf(['hover', 'click', 'focus', 'context']), PropTypes.arrayOf(PropTypes.oneOf(['click', 'focus', 'context'])), PropTypes.arrayOf(PropTypes.oneOf(['hover', 'focus', 'context']))]),\n  open: PropTypes.bool,\n  onOpenChange: PropTypes.func,\n  pointing: PropTypes.bool,\n  position: PropTypes.oneOf(POSITIONS),\n  positionFixed: PropTypes.bool,\n  renderContent: PropTypes.func,\n  target: PropTypes.any,\n  trigger: customPropTypes.every([customPropTypes.disallow(['children']), PropTypes.any]),\n  tabbableTrigger: PropTypes.bool,\n  unstable_pinned: PropTypes.bool,\n  content: customPropTypes.shorthandAllowingChildren,\n  contentRef: customPropTypes.ref,\n  trapFocus: PropTypes.oneOfType([PropTypes.bool, PropTypes.object]),\n  autoFocus: PropTypes.oneOfType([PropTypes.bool, PropTypes.object])\n});\nPopup.defaultProps = {\n  accessibility: popupBehavior,\n  align: 'start',\n  position: 'above',\n  on: 'click',\n  mouseLeaveDelay: 500,\n  tabbableTrigger: true\n};\nPopup.handledProps = Object.keys(Popup.propTypes);\nPopup.Content = PopupContent;\nPopup.create = createShorthandFactory({\n  Component: Popup,\n  mappedProp: 'content'\n});\nexport default Popup;","map":{"version":3,"sources":["components/Popup/Popup.tsx"],"names":["popupClassName","Popup","context","React","setStart","setEnd","useTelemetry","accessibility","align","autoFocus","inline","children","contentRef","flipBoundary","on","mountNode","mouseLeaveDelay","offset","overflowBoundary","pointing","position","positionFixed","renderContent","tabbableTrigger","target","trapFocus","trigger","unstable_pinned","props","open","setOpen","useAutoControlled","initialValue","defaultValue","value","isOpenedByRightClick","setIsOpenedByRightClick","closeTimeoutId","popupContentRef","pointerTargetRef","triggerRef","triggerFocusableRef","rightClickReferenceObject","getA11yProps","useAccessibility","debugName","actionHandlers","closeAndFocusTrigger","e","close","toggle","trySetOpen","setPopupOpen","preventScroll","mapPropsToBehavior","disabled","rtl","handleDocumentClick","isOutsidePopupElement","getRefs","isOutsidePopupElementAndOutsideTriggerElement","handleDocumentKeyDown","keyCode","keyboardKey","isMatchingKey","lastContentRef","isLastOpenedPopup","activeDocument","bodyHasFocus","isOutsidePopup","isInsideTrigger","doesNodeContainClick","isInsideNested","childRef","getTriggerProps","triggerProps","normalizedOn","args","isFromKeyboard","shouldBlurClose","setWhatInputSource","getContentProps","contentHandlerProps","predefinedProps","renderPopperChildren","placement","scheduleUpdate","content","popupContent","defaultProps","pointerRef","overrideProps","handleRef","nestingRef","dismissOnScroll","newValue","isRightClick","updateTriggerFocusableRef","updateContextPosition","event","clearTimeout","newOpen","schedulePopupClose","setTimeout","onClose","activeElement","nativeEvent","createReferenceFromContextClick","process","console","triggerNode","childrenExist","contentElement","triggerElement","element","as","PropTypes","defaultOpen","customPropTypes","onOpenChange","Object","createShorthandFactory","Component","mappedProp"],"mappings":"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","sourcesContent":["import { Accessibility, popupBehavior, PopupBehaviorProps } from '@fluentui/accessibility';\nimport {\n  AutoFocusZoneProps,\n  FocusTrapZoneProps,\n  useAccessibility,\n  useAutoControlled,\n  useTelemetry,\n} from '@fluentui/react-bindings';\nimport { EventListener } from '@fluentui/react-component-event-listener';\nimport { NodeRef, Unstable_NestingAuto } from '@fluentui/react-component-nesting-registry';\nimport { handleRef, Ref } from '@fluentui/react-component-ref';\nimport * as customPropTypes from '@fluentui/react-proptypes';\nimport * as PopperJs from '@popperjs/core';\nimport * as keyboardKey from 'keyboard-key';\nimport * as _ from 'lodash';\nimport * as PropTypes from 'prop-types';\nimport * as React from 'react';\n// @ts-ignore\nimport { ThemeContext } from 'react-fela';\n\nimport {\n  childrenExist,\n  ChildrenComponentProps,\n  ContentComponentProps,\n  StyledComponentProps,\n  commonPropTypes,\n  isFromKeyboard,\n  doesNodeContainClick,\n  setWhatInputSource,\n} from '../../utils';\nimport {\n  ComponentEventHandler,\n  FluentComponentStaticProps,\n  ProviderContextPrepared,\n  ShorthandValue,\n} from '../../types';\nimport { ALIGNMENTS, POSITIONS, Popper, PositioningProps, PopperChildrenProps } from '../../utils/positioner';\nimport PopupContent, { PopupContentProps } from './PopupContent';\n\nimport { createShorthandFactory } from '../../utils/factories';\nimport createReferenceFromContextClick from './createReferenceFromContextClick';\nimport isRightClick from '../../utils/isRightClick';\nimport PortalInner from '../Portal/PortalInner';\n\nexport type PopupEvents = 'click' | 'hover' | 'focus' | 'context';\nexport type RestrictedClickEvents = 'click' | 'focus';\nexport type RestrictedHoverEvents = 'hover' | 'focus' | 'context';\nexport type PopupEventsArray = RestrictedClickEvents[] | RestrictedHoverEvents[];\n\nexport interface PopupProps\n  extends StyledComponentProps<PopupProps>,\n    ChildrenComponentProps,\n    ContentComponentProps<ShorthandValue<PopupContentProps>>,\n    PositioningProps {\n  /**\n   * Accessibility behavior if overridden by the user.\n   * @available dialogBehavior\n   */\n  accessibility?: Accessibility<PopupBehaviorProps>;\n\n  /** Additional CSS class name(s) to apply.  */\n  className?: string;\n\n  /** Initial value for 'open'. */\n  defaultOpen?: boolean;\n\n  /** Whether the Popup should be rendered inline with the trigger or in the body. */\n  inline?: boolean;\n\n  /** Existing element the popup should be bound to. */\n  mountNode?: HTMLElement;\n\n  /** Delay in ms for the mouse leave event, before the popup will be closed. */\n  mouseLeaveDelay?: number;\n\n  /** Events triggering the popup. */\n  on?: PopupEvents | PopupEventsArray;\n\n  /** Defines whether popup is displayed. */\n  open?: boolean;\n\n  /**\n   * Event for request to change 'open' value.\n   * @param event - React's original SyntheticEvent.\n   * @param data - All props and proposed value.\n   */\n  onOpenChange?: ComponentEventHandler<PopupProps>;\n\n  /** A popup can show a pointer to trigger. */\n  pointing?: boolean;\n\n  /**\n   * Function to render popup content.\n   * @param updatePosition - function to request popup position update.\n   */\n  renderContent?: (updatePosition: Function) => ShorthandValue<PopupContentProps>;\n\n  /**\n   * DOM element that should be used as popup's target - instead of 'trigger' element that is used by default.\n   */\n  target?: HTMLElement;\n\n  /** Element to be rendered in-place where the popup is defined. */\n  trigger?: React.ReactNode;\n\n  /** Whether the trigger should be tabbable */\n  tabbableTrigger?: boolean;\n\n  /** Ref for Popup content DOM node. */\n  contentRef?: React.Ref<HTMLElement>;\n\n  /** Controls whether or not focus trap should be applied, using boolean or FocusTrapZoneProps type value. */\n  trapFocus?: boolean | FocusTrapZoneProps;\n\n  /** Controls whether or not auto focus should be applied, using boolean or AutoFocusZoneProps type value. */\n  autoFocus?: boolean | AutoFocusZoneProps;\n}\n\nexport const popupClassName = 'ui-popup';\n\n/**\n * A Popup displays a non-modal, often rich content, on top of its target element.\n */\nconst Popup: React.FC<PopupProps> &\n  FluentComponentStaticProps<PopupProps> & {\n    Content: typeof PopupContent;\n  } = props => {\n  const context: ProviderContextPrepared = React.useContext(ThemeContext);\n  const { setStart, setEnd } = useTelemetry(Popup.displayName, context.telemetry);\n  setStart();\n\n  const {\n    accessibility,\n    align,\n    autoFocus,\n    inline,\n    children,\n    contentRef,\n    flipBoundary,\n    on,\n    mountNode,\n    mouseLeaveDelay,\n    offset,\n    overflowBoundary,\n    pointing,\n    position,\n    positionFixed,\n    renderContent,\n    tabbableTrigger,\n    target,\n    trapFocus,\n    trigger,\n    unstable_pinned,\n  } = props;\n\n  const [open, setOpen] = useAutoControlled({\n    initialValue: false,\n    defaultValue: props.defaultOpen,\n    value: props.open,\n  });\n  const [isOpenedByRightClick, setIsOpenedByRightClick] = React.useState(false);\n\n  const closeTimeoutId = React.useRef<number | undefined>();\n\n  const popupContentRef = React.useRef<HTMLElement>();\n  const pointerTargetRef = React.useRef<HTMLElement>();\n  const triggerRef = React.useRef<HTMLElement>();\n  // focusable element which has triggered Popup, can be either triggerDomElement or the element inside it\n  const triggerFocusableRef = React.useRef<HTMLElement>();\n  const rightClickReferenceObject = React.useRef<PopperJs.VirtualElement | null>();\n\n  const getA11yProps = useAccessibility(accessibility, {\n    debugName: Popup.displayName,\n    actionHandlers: {\n      closeAndFocusTrigger: e => {\n        e.preventDefault();\n        close(e, () => _.invoke(triggerFocusableRef.current, 'focus'));\n      },\n      close: e => {\n        close(e);\n      },\n      toggle: e => {\n        e.preventDefault();\n        trySetOpen(!open, e);\n      },\n      open: e => {\n        e.preventDefault();\n        setPopupOpen(true, e);\n      },\n      preventScroll: e => {\n        e.preventDefault();\n      },\n    },\n    mapPropsToBehavior: () => ({\n      disabled: false, // definition has this prop, but `Popup` doesn't support it\n      isOpenedByRightClick,\n      on,\n      trapFocus,\n      tabbableTrigger,\n      trigger: trigger as any,\n    }),\n    rtl: context.rtl,\n  });\n\n  const handleDocumentClick = (getRefs: Function) => (e: MouseEvent) => {\n    if (isOpenedByRightClick && isOutsidePopupElement(getRefs(), e)) {\n      trySetOpen(false, e);\n      return;\n    }\n\n    if (isOutsidePopupElementAndOutsideTriggerElement(getRefs(), e)) {\n      trySetOpen(false, e);\n    }\n  };\n\n  const handleDocumentKeyDown = (getRefs: Function) => (e: KeyboardEvent) => {\n    const keyCode = keyboardKey.getCode(e);\n    const isMatchingKey = keyCode === keyboardKey.Enter || keyCode === keyboardKey.Spacebar;\n\n    if (isMatchingKey && isOutsidePopupElementAndOutsideTriggerElement(getRefs(), e)) {\n      trySetOpen(false, e);\n    }\n\n    // if focus was lost from Popup and moved to body, for e.g. when click on popup content\n    // and ESC is pressed, the last opened Popup should get closed and the trigger should get focus\n    const lastContentRef = getRefs().pop();\n    const isLastOpenedPopup: boolean = lastContentRef && lastContentRef.current === popupContentRef.current;\n\n    const activeDocument: HTMLDocument = context.target;\n    const bodyHasFocus: boolean = activeDocument.activeElement === activeDocument.body;\n\n    if (keyCode === keyboardKey.Escape && bodyHasFocus && isLastOpenedPopup) {\n      close(e, () => _.invoke(triggerFocusableRef.current, 'focus'));\n    }\n  };\n\n  const isOutsidePopupElementAndOutsideTriggerElement = (refs: NodeRef[], e: KeyboardEvent | MouseEvent) => {\n    const isOutsidePopup = isOutsidePopupElement(refs, e);\n    const isInsideTrigger =\n      triggerRef.current && doesNodeContainClick(triggerRef.current, e as MouseEvent, context.target);\n\n    return isOutsidePopup && !isInsideTrigger;\n  };\n\n  const isOutsidePopupElement = (refs: NodeRef[], e) => {\n    const isInsideNested = _.some(refs, (childRef: NodeRef) => {\n      return doesNodeContainClick(childRef.current as HTMLElement, e, context.target);\n    });\n    const isOutsidePopup = popupContentRef.current && !isInsideNested;\n\n    return isOutsidePopup;\n  };\n\n  const getTriggerProps = triggerElement => {\n    const triggerProps: any = {};\n    const normalizedOn = _.isArray(on) ? on : [on];\n\n    /**\n     * The focus is adding the focus, blur and click event (always opening on click)\n     * If focus and context are provided, there is no need to add onClick\n     */\n    if (_.includes(normalizedOn, 'focus')) {\n      triggerProps.onFocus = (e, ...args) => {\n        if (isFromKeyboard()) {\n          trySetOpen(true, e);\n        }\n        _.invoke(triggerElement, 'props.onFocus', e, ...args);\n      };\n      triggerProps.onBlur = (e, ...args) => {\n        if (shouldBlurClose(e)) {\n          trySetOpen(false, e);\n        }\n        _.invoke(triggerElement, 'props.onBlur', e, ...args);\n      };\n      if (!_.includes(normalizedOn, 'context')) {\n        triggerProps.onClick = (e, ...args) => {\n          setPopupOpen(true, e);\n          _.invoke(triggerElement, 'props.onClick', e, ...args);\n        };\n      }\n    }\n\n    /**\n     * The click is toggling the open state of the popup\n     */\n    if (_.includes(normalizedOn, 'click')) {\n      triggerProps.onClick = (e, ...args) => {\n        trySetOpen(!open, e);\n        _.invoke(triggerElement, 'props.onClick', e, ...args);\n      };\n    }\n\n    /**\n     * The context is opening the popup\n     */\n    if (_.includes(normalizedOn, 'context')) {\n      triggerProps.onContextMenu = (e, ...args) => {\n        setPopupOpen(!open, e);\n        _.invoke(triggerElement, 'props.onContextMenu', e, ...args);\n        e.preventDefault();\n      };\n    }\n\n    /**\n     * The hover is adding the mouseEnter, mouseLeave, blur and click event (always opening on click)\n     * If hover and context are provided, there is no need to add onClick\n     */\n    if (_.includes(normalizedOn, 'hover')) {\n      triggerProps.onMouseEnter = (e, ...args) => {\n        setPopupOpen(true, e);\n        setWhatInputSource(context.target, 'mouse');\n        _.invoke(triggerElement, 'props.onMouseEnter', e, ...args);\n      };\n      triggerProps.onMouseLeave = (e, ...args) => {\n        setPopupOpen(false, e);\n        _.invoke(triggerElement, 'props.onMouseLeave', e, ...args);\n      };\n      if (!_.includes(normalizedOn, 'context')) {\n        triggerProps.onClick = (e, ...args) => {\n          setPopupOpen(true, e);\n          _.invoke(triggerElement, 'props.onClick', e, ...args);\n        };\n      }\n      triggerProps.onBlur = (e, ...args) => {\n        if (shouldBlurClose(e)) {\n          trySetOpen(false, e);\n        }\n        _.invoke(triggerElement, 'props.onBlur', e, ...args);\n      };\n    }\n\n    return triggerProps;\n  };\n\n  const getContentProps = (predefinedProps?) => {\n    const contentHandlerProps: any = {};\n    const normalizedOn = _.isArray(on) ? on : [on];\n\n    /**\n     * The focus is adding the focus and blur events on the content\n     */\n    if (_.includes(normalizedOn, 'focus')) {\n      contentHandlerProps.onFocus = (e, contentProps) => {\n        trySetOpen(true, e);\n        predefinedProps && _.invoke(predefinedProps, 'onFocus', e, contentProps);\n      };\n      contentHandlerProps.onBlur = (e, contentProps) => {\n        if (shouldBlurClose(e)) {\n          trySetOpen(false, e);\n        }\n        predefinedProps && _.invoke(predefinedProps, 'onBlur', e, contentProps);\n      };\n    }\n\n    /**\n     * The hover is adding the mouseEnter, mouseLeave and click event (always opening on click)\n     */\n    if (_.includes(normalizedOn, 'hover')) {\n      contentHandlerProps.onMouseEnter = (e, contentProps) => {\n        setPopupOpen(true, e);\n        predefinedProps && _.invoke(predefinedProps, 'onMouseEnter', e, contentProps);\n      };\n      contentHandlerProps.onMouseLeave = (e, contentProps) => {\n        setPopupOpen(false, e);\n        predefinedProps && _.invoke(predefinedProps, 'onMouseLeave', e, contentProps);\n      };\n      contentHandlerProps.onClick = (e, contentProps) => {\n        setPopupOpen(true, e);\n        predefinedProps && _.invoke(predefinedProps, 'onClick', e, contentProps);\n      };\n    }\n\n    return contentHandlerProps;\n  };\n\n  const shouldBlurClose = e => {\n    return (\n      !e.currentTarget ||\n      !popupContentRef.current ||\n      (!e.currentTarget.contains(e.relatedTarget) && !popupContentRef.current.contains(e.relatedTarget))\n    );\n  };\n\n  const renderPopperChildren = ({ placement, scheduleUpdate }: PopperChildrenProps) => {\n    const content = renderContent ? renderContent(scheduleUpdate) : props.content;\n    const popupContent = Popup.Content.create(content || {}, {\n      defaultProps: () =>\n        getA11yProps('popup', {\n          ...getContentProps(),\n          placement,\n          pointing,\n          pointerRef: pointerTargetRef,\n          trapFocus,\n          autoFocus,\n        }),\n      overrideProps: getContentProps,\n    });\n\n    return (\n      <Unstable_NestingAuto>\n        {(getRefs, nestingRef) => (\n          <>\n            <Ref\n              innerRef={domElement => {\n                popupContentRef.current = domElement;\n                handleRef(contentRef, domElement);\n                nestingRef.current = domElement;\n              }}\n            >\n              {popupContent}\n            </Ref>\n\n            <EventListener listener={handleDocumentClick(getRefs)} target={context.target} type=\"click\" capture />\n            <EventListener listener={handleDocumentClick(getRefs)} target={context.target} type=\"contextmenu\" capture />\n            <EventListener listener={handleDocumentKeyDown(getRefs)} target={context.target} type=\"keydown\" capture />\n\n            {isOpenedByRightClick && (\n              <>\n                <EventListener listener={dismissOnScroll} target={context.target} type=\"wheel\" capture />\n                <EventListener listener={dismissOnScroll} target={context.target} type=\"touchmove\" capture />\n              </>\n            )}\n          </>\n        )}\n      </Unstable_NestingAuto>\n    );\n  };\n\n  const dismissOnScroll = (e: TouchEvent | WheelEvent) => {\n    trySetOpen(false, e);\n  };\n\n  const trySetOpen = (\n    newValue: boolean,\n    event: React.KeyboardEvent | React.MouseEvent | KeyboardEvent | MouseEvent | TouchEvent | WheelEvent,\n  ) => {\n    const isOpenedByRightClick = newValue && isRightClick(event as React.MouseEvent);\n\n    // when new state 'open' === 'true', save the last focused element\n    if (newValue) {\n      updateTriggerFocusableRef();\n      updateContextPosition(isOpenedByRightClick && (event as React.MouseEvent).nativeEvent);\n    }\n\n    setOpen(newValue);\n    setIsOpenedByRightClick(isOpenedByRightClick);\n\n    _.invoke(props, 'onOpenChange', event, { ...props, ...{ open: newValue } });\n  };\n\n  const setPopupOpen = (newOpen: boolean, e: React.KeyboardEvent) => {\n    clearTimeout(closeTimeoutId.current);\n    newOpen ? trySetOpen(true, e) : schedulePopupClose(e);\n  };\n\n  const schedulePopupClose = (e: React.KeyboardEvent) => {\n    closeTimeoutId.current = setTimeout(() => {\n      trySetOpen(false, e);\n    }, mouseLeaveDelay) as any;\n  };\n\n  const close = (e, onClose?: Function) => {\n    if (open) {\n      trySetOpen(false, e);\n      onClose && onClose();\n      e.stopPropagation();\n    }\n  };\n\n  /**\n   * Save DOM element which had focus before Popup opens.\n   * Can be either trigger DOM element itself or the element inside it.\n   */\n  const updateTriggerFocusableRef = () => {\n    const activeDocument: HTMLDocument = context.target;\n    const activeElement = activeDocument.activeElement;\n\n    triggerFocusableRef.current =\n      triggerRef.current && triggerRef.current.contains(activeElement)\n        ? (activeElement as HTMLElement)\n        : triggerRef.current;\n  };\n\n  const updateContextPosition = (nativeEvent: MouseEvent) => {\n    rightClickReferenceObject.current = nativeEvent ? createReferenceFromContextClick(nativeEvent) : null;\n  };\n\n  if (process.env.NODE_ENV !== 'production') {\n    React.useEffect(() => {\n      if (inline && trapFocus) {\n        // eslint-disable-next-line no-console\n        console.warn('Using \"trapFocus\" in inline popup leads to broken behavior for screen reader users.');\n      }\n      if (!inline && autoFocus) {\n        // eslint-disable-next-line no-console\n        console.warn(\n          'Beware, \"autoFocus\" prop will just grab focus at the moment of mount and will not trap it. As user is able to TAB out from popup, better use \"inline\" prop to keep correct tab order.',\n        );\n      }\n    }, [autoFocus, inline, trapFocus]);\n  }\n\n  React.useEffect(() => {\n    if (open) {\n      // when new state 'open' === 'true', save the last focused element\n      updateTriggerFocusableRef();\n    }\n  });\n\n  const triggerNode: React.ReactNode | null = childrenExist(children) ? children : trigger;\n  const triggerProps = getTriggerProps(triggerNode);\n\n  const contentElement = open && (\n    <Popper\n      pointerTargetRef={pointerTargetRef}\n      align={align}\n      flipBoundary={flipBoundary}\n      position={position}\n      positionFixed={positionFixed}\n      offset={offset}\n      overflowBoundary={overflowBoundary}\n      rtl={context.rtl}\n      unstable_pinned={unstable_pinned}\n      targetRef={rightClickReferenceObject.current || target || triggerRef}\n      children={renderPopperChildren}\n    />\n  );\n  const triggerElement = triggerNode && (\n    <Ref innerRef={triggerRef}>\n      {React.cloneElement(triggerNode as React.ReactElement, getA11yProps('trigger', triggerProps))}\n    </Ref>\n  );\n\n  const element = (\n    <>\n      {triggerElement}\n      {open && (inline ? contentElement : <PortalInner mountNode={mountNode}>{contentElement}</PortalInner>)}\n    </>\n  );\n  setEnd();\n\n  return element;\n};\n\nPopup.displayName = 'Popup';\n\nPopup.propTypes = {\n  ...commonPropTypes.createCommon({\n    as: false,\n    content: false,\n  }),\n  align: PropTypes.oneOf(ALIGNMENTS),\n  defaultOpen: PropTypes.bool,\n  inline: PropTypes.bool,\n  mountNode: customPropTypes.domNode,\n  mouseLeaveDelay: PropTypes.number,\n  offset: PropTypes.oneOfType([\n    PropTypes.func,\n    PropTypes.arrayOf(PropTypes.number) as PropTypes.Requireable<[number, number]>,\n  ]),\n  flipBoundary: PropTypes.oneOfType([\n    PropTypes.object as PropTypes.Requireable<HTMLElement>,\n    PropTypes.arrayOf(PropTypes.object) as PropTypes.Requireable<HTMLElement[]>,\n    PropTypes.oneOf<'clippingParents' | 'window' | 'scrollParent'>(['clippingParents', 'window', 'scrollParent']),\n  ]),\n  overflowBoundary: PropTypes.oneOfType([\n    PropTypes.object as PropTypes.Requireable<HTMLElement>,\n    PropTypes.arrayOf(PropTypes.object) as PropTypes.Requireable<HTMLElement[]>,\n    PropTypes.oneOf<'clippingParents' | 'window' | 'scrollParent'>(['clippingParents', 'window', 'scrollParent']),\n  ]),\n  on: PropTypes.oneOfType([\n    PropTypes.oneOf(['hover', 'click', 'focus', 'context']),\n    PropTypes.arrayOf(PropTypes.oneOf(['click', 'focus', 'context'])),\n    PropTypes.arrayOf(PropTypes.oneOf(['hover', 'focus', 'context'])),\n  ]) as any,\n  open: PropTypes.bool,\n  onOpenChange: PropTypes.func,\n  pointing: PropTypes.bool,\n  position: PropTypes.oneOf(POSITIONS),\n  positionFixed: PropTypes.bool,\n  renderContent: PropTypes.func,\n  target: PropTypes.any,\n  trigger: customPropTypes.every([customPropTypes.disallow(['children']), PropTypes.any]),\n  tabbableTrigger: PropTypes.bool,\n  unstable_pinned: PropTypes.bool,\n  content: customPropTypes.shorthandAllowingChildren,\n  contentRef: customPropTypes.ref,\n  trapFocus: PropTypes.oneOfType([PropTypes.bool, PropTypes.object]),\n  autoFocus: PropTypes.oneOfType([PropTypes.bool, PropTypes.object]),\n};\nPopup.defaultProps = {\n  accessibility: popupBehavior,\n  align: 'start',\n  position: 'above',\n  on: 'click',\n  mouseLeaveDelay: 500,\n  tabbableTrigger: true,\n};\nPopup.handledProps = Object.keys(Popup.propTypes) as any;\n\nPopup.Content = PopupContent;\n\nPopup.create = createShorthandFactory({ Component: Popup, mappedProp: 'content' });\n\nexport default Popup;\n"]},"metadata":{},"sourceType":"module"}