{"version":3,"sources":["components/Menu/Menu.tsx"],"names":["menuBehavior","customPropTypes","mergeComponentVariables","PropTypes","React","AutoControlledComponent","childrenExist","createShorthandFactory","commonPropTypes","getKindProp","rtlTextContainer","MenuItem","withSafeTypeForAs","MenuDivider","menuClassName","Menu","e","activeIndex","props","setState","variables","predefinedProps","onClick","itemProps","index","setActiveIndex","onActiveChanged","active","state","styles","accessibility","iconOnly","items","pills","pointing","primary","secondary","underlined","vertical","submenu","indicator","itemsCount","item","length","itemPosition","overrideItemProps","handleItemOverrides","overrideDividerProps","handleDividerOverrides","parseInt","kind","create","defaultProps","divider","inSubmenu","childBehaviors","undefined","overrideProps","ElementType","classes","unhandledProps","children","attributes","root","getAttributes","forElements","renderItems","createCommon","content","oneOfType","number","string","defaultActiveIndex","fluid","bool","collectionShorthandWithKindProp","onItemClick","func","onActiveIndexChange","oneOf","every","disallow","shorthandAllowingChildren","as","Component","mappedArrayProp"],"mappings":"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","sourcesContent":["import { Accessibility, menuBehavior } from '@fluentui/accessibility';\nimport { ReactAccessibilityBehavior } from '@fluentui/react-bindings';\nimport * as customPropTypes from '@fluentui/react-proptypes';\nimport { ComponentVariablesObject, ComponentSlotStylesPrepared, mergeComponentVariables } from '@fluentui/styles';\nimport * as _ from 'lodash';\nimport * as PropTypes from 'prop-types';\nimport * as React from 'react';\n\nimport {\n  AutoControlledComponent,\n  childrenExist,\n  createShorthandFactory,\n  UIComponentProps,\n  ChildrenComponentProps,\n  commonPropTypes,\n  getKindProp,\n  rtlTextContainer,\n  ShorthandFactory,\n} from '../../utils';\n\nimport MenuItem, { MenuItemProps } from './MenuItem';\nimport { WithAsProp, ShorthandCollection, ShorthandValue, withSafeTypeForAs, ComponentEventHandler } from '../../types';\nimport MenuDivider from './MenuDivider';\nimport { BoxProps } from '../Box/Box';\n\nexport type MenuShorthandKinds = 'divider' | 'item';\n\nexport interface MenuProps extends UIComponentProps, ChildrenComponentProps {\n  /**\n   * Accessibility behavior if overridden by the user.\n   * @available menuAsToolbarBehavior, tabListBehavior, tabBehavior\n   */\n  accessibility?: Accessibility;\n\n  /** Index of the currently active item. */\n  activeIndex?: number | string;\n\n  /** Initial activeIndex value. */\n  defaultActiveIndex?: number | string;\n\n  /** A vertical menu may take the size of its container. */\n  fluid?: boolean;\n\n  /** A menu may have just icons. */\n  iconOnly?: boolean;\n\n  /** Shorthand array of props for Menu. */\n  items?: ShorthandCollection<MenuItemProps, MenuShorthandKinds>;\n\n  /**\n   * Called when a panel title is clicked.\n   *\n   * @param event - React's original SyntheticEvent.\n   * @param data - All item props.\n   */\n  onItemClick?: ComponentEventHandler<MenuItemProps>;\n\n  /**\n   * Called when the active index of the Menu changes.\n   * @param event - React's original SyntheticEvent.\n   * @param data - All props, with `activeIndex` reflecting the new state.\n   */\n  onActiveIndexChange?: ComponentEventHandler<MenuProps>;\n\n  /** A menu can adjust its appearance to de-emphasize its contents. */\n  pills?: boolean;\n\n  /**\n   * A menu can point to show its relationship to nearby content.\n   * For vertical menu, it can point to the start of the item or to the end.\n   */\n  pointing?: boolean | 'start' | 'end';\n\n  /** The menu can have primary type. */\n  primary?: boolean;\n\n  /** The menu can have secondary type. */\n  secondary?: boolean;\n\n  /** Menu items can by highlighted using underline. */\n  underlined?: boolean;\n\n  /** A vertical menu displays elements vertically. */\n  vertical?: boolean;\n\n  /** Indicates whether the menu is submenu. */\n  submenu?: boolean;\n\n  /** Shorthand for the submenu indicator. */\n  indicator?: ShorthandValue<BoxProps>;\n}\n\nexport interface MenuState {\n  activeIndex?: number | string;\n}\n\nexport const menuClassName = 'ui-menu';\n\nclass Menu extends AutoControlledComponent<WithAsProp<MenuProps>, MenuState> {\n  static displayName = 'Menu';\n\n  static deprecated_className = menuClassName;\n\n  static create: ShorthandFactory<MenuProps>;\n\n  static propTypes = {\n    ...commonPropTypes.createCommon({\n      content: false,\n    }),\n    activeIndex: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n    defaultActiveIndex: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n    fluid: PropTypes.bool,\n    iconOnly: PropTypes.bool,\n    items: customPropTypes.collectionShorthandWithKindProp(['divider', 'item']),\n    onItemClick: PropTypes.func,\n    onActiveIndexChange: PropTypes.func,\n    pills: PropTypes.bool,\n    pointing: PropTypes.oneOfType([PropTypes.bool, PropTypes.oneOf(['start', 'end'])]),\n    primary: customPropTypes.every([customPropTypes.disallow(['secondary']), PropTypes.bool]),\n    secondary: customPropTypes.every([customPropTypes.disallow(['primary']), PropTypes.bool]),\n    underlined: PropTypes.bool,\n    vertical: PropTypes.bool,\n    submenu: PropTypes.bool,\n    indicator: customPropTypes.shorthandAllowingChildren,\n  };\n\n  static defaultProps = {\n    as: 'ul',\n    accessibility: menuBehavior as Accessibility,\n  };\n\n  static autoControlledProps = ['activeIndex'];\n\n  static Item = MenuItem;\n  static Divider = MenuDivider;\n\n  setActiveIndex = (e: React.SyntheticEvent, activeIndex: number) => {\n    _.invoke(this.props, 'onActiveIndexChange', e, { ...this.props, activeIndex });\n    this.setState({ activeIndex });\n  };\n\n  handleItemOverrides = variables => predefinedProps => ({\n    onClick: (e, itemProps) => {\n      const { index } = itemProps;\n\n      this.setActiveIndex(e, index);\n\n      _.invoke(this.props, 'onItemClick', e, itemProps);\n      _.invoke(predefinedProps, 'onClick', e, itemProps);\n    },\n    onActiveChanged: (e, props) => {\n      const { index, active } = props;\n      if (active) {\n        this.setActiveIndex(e, index);\n      } else if (this.state.activeIndex === index) {\n        this.setActiveIndex(e, null);\n      }\n      _.invoke(predefinedProps, 'onActiveChanged', e, props);\n    },\n    variables: mergeComponentVariables(variables, predefinedProps.variables),\n  });\n\n  handleDividerOverrides = variables => predefinedProps => ({\n    variables: mergeComponentVariables(variables, predefinedProps.variables),\n  });\n\n  renderItems = (\n    styles: ComponentSlotStylesPrepared,\n    variables: ComponentVariablesObject,\n    accessibility: ReactAccessibilityBehavior,\n  ) => {\n    const {\n      iconOnly,\n      items,\n      pills,\n      pointing,\n      primary,\n      secondary,\n      underlined,\n      vertical,\n      submenu,\n      indicator,\n    } = this.props;\n    const { activeIndex } = this.state;\n    const itemsCount = _.filter(items, item => getKindProp(item, 'item') !== 'divider').length;\n    let itemPosition = 0;\n\n    const overrideItemProps = this.handleItemOverrides(variables);\n    const overrideDividerProps = this.handleDividerOverrides(variables);\n\n    return _.map(items, (item, index) => {\n      const active = (typeof activeIndex === 'string' ? parseInt(activeIndex, 10) : activeIndex) === index;\n      const kind = getKindProp(item, 'item');\n\n      if (kind === 'divider') {\n        return MenuDivider.create(item, {\n          defaultProps: () => ({\n            primary,\n            secondary,\n            vertical,\n            styles: styles.divider,\n            inSubmenu: submenu,\n            accessibility: accessibility.childBehaviors ? accessibility.childBehaviors.divider : undefined,\n          }),\n          overrideProps: overrideDividerProps,\n        });\n      }\n\n      itemPosition++;\n\n      return MenuItem.create(item, {\n        defaultProps: () => ({\n          iconOnly,\n          pills,\n          pointing,\n          primary,\n          secondary,\n          underlined,\n          vertical,\n          index,\n          itemPosition,\n          itemsCount,\n          active,\n          inSubmenu: submenu,\n          indicator,\n          accessibility: accessibility.childBehaviors ? accessibility.childBehaviors.item : undefined,\n        }),\n        overrideProps: overrideItemProps,\n      });\n    });\n  };\n\n  renderComponent({ ElementType, classes, accessibility, styles, variables, unhandledProps }) {\n    const { children } = this.props;\n    return (\n      <ElementType\n        {...accessibility.attributes.root}\n        {...rtlTextContainer.getAttributes({ forElements: [children] })}\n        {...unhandledProps}\n        className={classes.root}\n      >\n        {childrenExist(children) ? children : this.renderItems(styles, variables, accessibility)}\n      </ElementType>\n    );\n  }\n}\n\nMenu.create = createShorthandFactory({ Component: Menu, mappedArrayProp: 'items' });\n\n/**\n * A Menu is a component that offers a grouped list of choices to the user.\n *\n * @accessibility\n * Implements ARIA [Menu](https://www.w3.org/TR/wai-aria-practices-1.1/#menu), [Toolbar](https://www.w3.org/TR/wai-aria-practices-1.1/#toolbar) or [Tabs](https://www.w3.org/TR/wai-aria-practices-1.1/#tabpanel) design pattern, depending on the behavior used.\n * @accessibilityIssues\n * [JAWS - navigation instruction for menubar](https://github.com/FreedomScientific/VFO-standards-support/issues/203)\n * [JAWS - navigation instruction for menu with aria-orientation=\"horizontal\"](https://github.com/FreedomScientific/VFO-standards-support/issues/204)\n * [JAWS [VC] doesn't narrate menu item, when it is open from menu button](https://github.com/FreedomScientific/VFO-standards-support/issues/324)\n * [JAWS [app mode] focus moves to second menu item, when it is open from menu button](https://github.com/FreedomScientific/VFO-standards-support/issues/325)\n * [Enter into a tablist JAWS narrates: To switch pages, press Control+PageDown](https://github.com/FreedomScientific/VFO-standards-support/issues/337)\n * 51114083 VoiceOver+Web narrate wrong position in menu / total count of menu items, when pseudo element ::after or ::before is used\n */\nexport default withSafeTypeForAs<typeof Menu, MenuProps, 'ul'>(Menu);\n"],"file":"Menu.js"}